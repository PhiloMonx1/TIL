## 015 [하드웨어] 캐시가 뭔가요

---

> 그러므로 우리는 메모리를 계층 구조로 만들 가능성이 있음을 결국 인식하게 된다. 여기서 각 단계의 메모리는 앞 단계보다 용량은 더 크고 접근 속도는 느리다. - 아서 빅스, 허먼 골드스타인, 폰 노이만, 1946

### 메모리 계층 구조의 개념
- 메모리 계층 구조
  - 컴퓨터 시스템에서 메모리는 여러 계층으로 구성된다.
  - 각 계층은 서로 다른 속도와 용량을 가진다.
- 계층별 특성
  - 상위 계층: 속도가 빠르지만 용량이 작음 (예: CPU 캐시, 레지스터)
  - 하위 계층: 속도가 느리지만 용량이 큼 (예: 주 메모리, 하드 디스크)
- 트레이드오프
  - 속도와 용량 사이의 균형을 맞추는 것이 중요하다.
  - 빠른 접근 속도와 큰 저장 용량을 동시에 얻기 어렵다.

### 캐싱
용량이 작고 속도가 빠른 메모리에 최근에 사용된 정보를 저장하여, 더 큰 용량이지만 느린 주 기억 장치에 매번 접근하는 것을 피하는 방법.
- 빠른 메모리에 데이터를 저장하여 더 빠르게 접근할 수 있도록 하는 모든 기법을 통틀어서 말한다.
- Redis도 일종의 캐싱이다.
  - 원하는 데이터를 RAM에 저장하고 관리해주는 '인메모리 데이터 구조 저장' 시스템
  - 메모리에 직접 데이터를 저장하는 것은 일반적으로 개발자가 직접 관리하기 어려운 부분이기에 이러한 툴의 도움을 받아 캐싱 전략을 사용할 수 있다.

### 프로세서 캐싱
프로세서에도 캐싱 전략이 적용되어 있으며, CPU 캐시라고 부른다.
- 최근에 사용된 명령어와 데이터를 저장하여, 메모리 접근 시간을 줄이고 실행 속도를 높이는 방법이다.
- 반복적으로 접근하는 명령어와 데이터를 캐시에 저장해서, 메모리 접근 시간을 줄여 프로그램 실행 속도를 높일 수 있다.
- 일반적인 프로세서의 캐시는 2~3개의 레벨을 나누어서 구성되어 있다.
  - L1 캐시: 가장 빠르고 용량이 작음.
  - L2 캐시: L1보다 느리지만 용량이 큼.
  - L3 캐시: 가장 느리지만 용량이 큼.
- 캐시가 효과적인 이유는 최근 사용된 정보가 다시 사용될 가능성이 크기 때문이다.
- **프로세서의 '누산기' 역시 무언가를 저장하고 그것을 다시 사용한다는 점에서 캐시라고 할 수 있다.**

### 백엔드가 알아야 할 캐싱 전략 
- LRU(Least Recently Used):
  - 가장 오랫동안 사용되지 않은 데이터를 먼저 제거하는 방식.
  - Redis의 기본 알고리즘이다.
- TTL(Time To Live):
  - 데이터에 유효 기간을 설정하여, 일정 시간이 지나면 자동으로 제거하는 방식
  - Redis에서는 키에 TTL을 설정하여 이 기능을 구현할 수 있다.
- Write-Through:
  - 데이터가 캐시에 쓰일 때 동시에 데이터베이스에도 쓰이는 방식.
  - 데이터 일관성을 유지하는 데 유리하다.
- Write-Behind:
  - 데이터가 캐시에 쓰일 때, 일정 시간 후에 데이터베이스에 반영하는 방식.
  - 쓰기 성능을 향상시키지만, 데이터 일관성 관리가 필요하다.